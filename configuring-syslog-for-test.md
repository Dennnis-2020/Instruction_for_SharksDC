

Для настройки логирвоания на syslog сервер потребуется создать конфигурацию конечной точки логирования. Конфигурация включает в себя:
- Протокол отправки сообщений (UDP/TCP)
- Адрес/домен сервера
- Порт сервера
- Флаг использования TLS
- Данные сертификата сервера

Во ВЦОД может существовать только одна конфигурация коненой точки syslog-сервера.

При добавлении конфигурации обязательно указывается протокол и адрес. Если порт не указан, по умолчанию присваивается 514 для UDP и 1468 для TCP.  
Подключение по TLS доступно только в конфигурациях, где выбран протокол TCP. Для подключение с TLS необходимо предоставить сертификат сервера.

## Пример настройки конечной точки подключения по TCP с TLS:  

Здесь описывается процесс конфигурации подключения где используется самоподписанный сертификат.  

Пример генерации приватного ключа `key.pem` и самоподписанного сертификата `cert.pem` на 10 лет:  
```
openssl req -x509 -nodes -newkey rsa:4096 -keyout key.pem -out cert.pem -sha256 -days 3650 -addext 'subjectAltName=IP:<rsyslog-server-addr>'
```  

в сертификате должен присутствовать `subjectAltName`, соответствующий адресу/домену сервера:
`subjectAltName=IP:<server-ip-address>` / `subjectAltName=DNS:<server-domain-name>`

Настройка конечной точки:

```
aaaevents syslog add --protocol tcp --address <rsyslog-server-addr> --use_tls yes --ca_file <full-path-to-certificate>
```  

`<full-path-to-certificate>` - сгенерированный ранее сертификат.

Также содержимое сертификата можно передать строкой:

```
... --ca_data "-----BEGIN CERTIFICATE-----\nMIIDnjCCAoagA...G05Ub0k\n-----END CERTIFICATE-----\n"
```
*важно, чтобы разделителем строк был символ `\n`*  
*параметры `--ca_file` и `--ca_data` не могут быть использованы одновременно*  

Для корректной работы rsyslog сервера с TLS потребуется установить системный пакет `rsyslog-gnutls` на сервер
Больше о конфигурации сервера с TLS: https://www.rsyslog.com/doc/tutorials/tls.html#server-setup